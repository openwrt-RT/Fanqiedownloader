


# 番茄小说下载器

一个基于Web的工具，用于从番茄小说下载内容并生成EPUB格式电子书，支持多线程下载和队列管理。

---

## 功能特性
- 📚 多线程高速下载章节内容（最高支持16线程）
- 🕹 可视化网页操作界面（自动打开浏览器）
- 📥 批量任务队列管理（支持顺序下载）
- 📊 实时进度条与百分比显示
- 🗑 已下载书籍管理（支持本地删除）
- 📖 自动生成标准EPUB（含目录/封面）
- ⚡ 智能元数据抓取（书名/作者/封面）

---

## 安装与运行

### 环境要求
- Python 3.6 或更高版本
- 支持现代浏览器（推荐Chrome/Edge）

### 安装依赖
```bash
pip install requests flask ebooklib beautifulsoup4 tqdm
```

### 启动程序
```bash
python get2.py
```
启动后自动打开浏览器访问 `http://127.0.0.1:5000`

---

## 详细使用指南

### 1. 获取book_id
- **操作路径**：打开番茄小说网页版 → 进入目标书籍详情页
- **获取方式**：
  - 查看浏览器地址栏，格式为：`https://fanqienovel.com/book/123456`
  - `123456`即为book_id（仅数字部分）
- **示例**：
  ```
  https://fanqienovel.com/book/70412345678
                              ↑↑↑↑↑↑↑↑↑↑↑↑
  有效book_id为：70412345678


### 2. 添加下载任务
- **操作步骤**：
  1. 在网页界面输入框填写获取的book_id
  2. 设置线程数（默认8，建议值）：
     - 低配置电脑：4-8线程
     - 高性能电脑：8-16线程
    3. 点击「添加到队列」按钮
- **注意事项**：
  - 可连续添加多个book_id形成下载队列
  - 任务按添加顺序自动执行
  - 当前任务失败会自动跳转至下一任务

### 3. 监控下载进度
- **实时状态显示**：
  - 顶部进度条：章节完成百分比
  - 状态文字：当前书籍名/已完成章节数
  - 队列高亮：正在下载的任务会标记为蓝色
### 4. 管理下载队列
- **队列操作**：
  - 查看队列：所有待下载任务按添加顺序排列
  - 终止队列：关闭程序即清空未完成任务
  - 错误处理：单个任务失败会自动跳过并记录错误
- **优先级规则**：
  - 先添加的任务优先下载
  - 正在执行的任务无法插队或取消

### 5. 下载完成管理
- **文件存放**：
  - EPUB自动保存到程序目录下的`download`文件夹
  - 文件名格式：`书名.epub`（自动去除非法字符）
- **网页端操作**：
  - 📥 下载：点击「下载」按钮直接保存到本地
  - 🗑 删除：点击「删除」永久移除本地文件
  - 列表刷新：删除后自动更新显示状态
- **文件安全**：
  - 下载前自动检查重名文件（不会覆盖已有文件）
  - 删除操作需要二次确认

### 6. 异常处理
- **常见问题**：
  - ❌ 长时间卡在0%：
    - 检查网络连接
    - 确认book_id有效性
    - 重启程序后重试
  - ❌ 封面获取失败：
    - 自动使用默认封面模板
    - 不影响正文内容完整性
  - ❌ 章节内容缺失：
    - 重试下载任务
    - 检查原始书籍是否下架

---

## 注意事项
1. **网络要求**：
   - 需要稳定访问番茄小说API（非中国大陆用户可能需要代理）
   - 单个章节下载超时时间为10秒

2. **文件存储**：
   - 首次运行自动创建`download`目录
   - 建议保留至少500MB磁盘空间

3. **性能建议**：
   - 内存占用约200-500MB（根据书籍长度）
   - 不建议同时运行其他高内存程序

4. **兼容性说明**：
   - 适配番茄小说2023年新版API
   - EPUB兼容主流阅读器（Kindle/iBooks/calibre）



---

